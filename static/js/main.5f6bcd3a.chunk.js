(this["webpackJsonpmy-notes-app"]=this["webpackJsonpmy-notes-app"]||[]).push([[0],{120:function(e,t,n){"use strict";n.r(t);var r=n(20),a=n(4),c=n(147),o=n(148),i=n(152),s=n(1),u=n(38),l=n.n(u),b=n(12),j=n.n(b),d=n(24),p=n(5),O=n(21),m=n(41),f=n(150),k=n(145),x=n(137),h=n(140),v=n(153),g=n(134),y=n(146),S=n(141),w=n(151),C=n(130),B=n(139),R=n(87),E=n(68),A=n(91),D=n(135),N=n(136),I=n(149),F=n(131),M=n(93),U=n(133),T=n(94),L=n(51),J=j.a.mark(z),q=j.a.mark(H);function z(e){var t,n,r,a;return j.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:t=new Set,n=Object(L.a)(e),c.prev=2,n.s();case 4:if((r=n.n()).done){c.next=13;break}if(a=r.value,!t.has(a)){c.next=8;break}return c.abrupt("continue",11);case 8:return c.next=10,a;case 10:t.add(a);case 11:c.next=4;break;case 13:c.next=18;break;case 15:c.prev=15,c.t0=c.catch(2),n.e(c.t0);case 18:return c.prev=18,n.f(),c.finish(18);case 21:case"end":return c.stop()}}),J,null,[[2,15,18,21]])}function H(e,t){var n,r,a;return j.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:n=Object(L.a)(t),c.prev=1,n.s();case 3:if((r=n.n()).done){c.next=9;break}return a=r.value,c.next=7,e(a);case 7:c.next=3;break;case 9:c.next=14;break;case 11:c.prev=11,c.t0=c.catch(1),n.e(c.t0);case 14:return c.prev=14,n.f(),c.finish(14);case 17:case"end":return c.stop()}}),q,null,[[1,11,14,17]])}function V(e){return 1===e.split("//").length?"https://".concat(e):e}function _(e){return t=z(H((function(e){return e.toLowerCase()}),e)),Array.from(t);var t}function P(e){var t=e.name,n=e.url,r=e.description,a=void 0===r?"":r,c=e.tags,o=void 0===c?[]:c,i=(new Date).toISOString();return{id:Object(T.a)(),url:V(n),name:t,description:a,tags:_(o),createdAt:i,updatedAt:i}}var G=n(37),K=n(127),Q=n(128),W=n(71);var X={Form:function(e){return Object(a.jsx)(W.b,{initialValues:e.initialValues,onSubmit:e.onSubmit,validate:e.validate,render:function(t){var n=t.handleSubmit;return Object(a.jsx)("form",{onSubmit:n,children:e.children})}})},Field:function(e){return Object(a.jsx)(W.a,{name:e.name,render:function(t){var n=t.input,r=t.meta;return Object(a.jsxs)(G.a,{id:e.id,isRequired:e.isRequired,isInvalid:r.touched&&r.error,children:[Object(a.jsx)(K.a,{children:e.label}),e.render(n),Object(a.jsxs)(Q.b,{children:[Object(a.jsx)(Q.a,{})," ",r.error]})]})}})}},Y=X.Form,Z=X.Field;function $(e){var t,n,r={};return 0===((null===(t=e.name)||void 0===t?void 0:t.trim())||"").length&&(r.name="Name can not be empty"),0===((null===(n=e.url)||void 0===n?void 0:n.trim())||"").length&&(r.url="URL can not be empty"),r}function ee(e){var t,n,c,o,i=e.title,u=e.bookmark,l=e.isOpen,b=e.onClose,j=e.onSubmit,d=Object(s.useRef)(null);var p={description:null!==(t=null===u||void 0===u?void 0:u.description)&&void 0!==t?t:"",name:null!==(n=null===u||void 0===u?void 0:u.name)&&void 0!==n?n:"",tags:null!==(c=null===u||void 0===u?void 0:u.tags.join(", "))&&void 0!==c?c:"",url:null!==(o=null===u||void 0===u?void 0:u.url)&&void 0!==o?o:""};return Object(a.jsxs)(I.a,{isOpen:l,onClose:b,children:[Object(a.jsx)(I.g,{}),Object(a.jsx)(Y,{onSubmit:function(e){var t={name:e.name,description:e.description,url:e.url,tags:e.tags.split(/[\s,]+/).filter(Boolean)};j(u?function(e,t){var n,a;return Object(r.a)(Object(r.a)(Object(r.a)({},e),t),{},{url:V(null!==(n=t.url)&&void 0!==n?n:e.url),tags:_(null!==(a=t.tags)&&void 0!==a?a:e.tags),updatedAt:(new Date).toISOString()})}(u,t):P(t)),b()},initialValues:p,validate:$,children:Object(a.jsxs)(I.d,{children:[Object(a.jsx)(I.f,{children:i}),Object(a.jsx)(I.c,{}),Object(a.jsx)(I.b,{children:Object(a.jsxs)(v.b,{children:[Object(a.jsx)(Z,{name:"name",label:"Name",id:"bookmark-name",isRequired:!0,render:function(e){return Object(a.jsx)(C.a,Object(r.a)({ref:d},e))}}),Object(a.jsx)(Z,{name:"url",label:"URL",id:"bookmark-url",isRequired:!0,render:function(e){return Object(a.jsx)(C.a,Object(r.a)({},e))}}),Object(a.jsx)(Z,{name:"description",label:"Description",id:"bookmark-description",render:function(e){return Object(a.jsx)(F.a,Object(r.a)({},e))}}),Object(a.jsx)(Z,{name:"tags",label:"Tags",id:"bookmark-tags",render:function(e){return Object(a.jsx)(F.a,Object(r.a)({},e))}})]})}),Object(a.jsxs)(I.e,{children:[Object(a.jsx)(M.a,{mr:3,onClick:b,children:"Cancel"}),Object(a.jsx)(M.a,{colorScheme:"blue",type:"submit",children:"Save"})]})]})})]})}function te(e){var t=e.onBookmarkCreate,n=Object(U.a)(),r=n.onClose,c=n.onOpen,o=n.isOpen;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(g.a,{"aria-label":"New bookmakr",icon:Object(a.jsx)(D.a,{}),onClick:c}),Object(a.jsx)(ee,{title:"New bookmark",onClose:r,isOpen:o,onSubmit:t})]})}function ne(e){var t=e.bookmark,n=e.onBookmarkUpdate,r=Object(U.a)(),c=r.onClose,o=r.onOpen,i=r.isOpen;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(g.a,{"aria-label":"New bookmakr",icon:Object(a.jsx)(N.a,{}),onClick:o}),Object(a.jsx)(ee,{title:"Edit bookmark",bookmark:t,onClose:c,isOpen:i,onSubmit:n})]})}var re=n(144),ae=n(154),ce=n(138),oe=n(142),ie=n(143);function se(e){var t=e.url,n=Object(s.useState)(!1),r=Object(p.a)(n,2),c=r[0],o=r[1],i=Object(s.useRef)(new Image);return Object(s.useEffect)((function(){var e=!1;return i.current.src=t,i.current.onload=function(){e||o(!0)},function(){o(!1),e=!0}}),[t]),Object(a.jsx)(x.a,{background:"gray.50",width:"24px",height:"24px",rounded:"full",display:"flex",justifyContent:"center",alignItems:"center",children:Object(a.jsx)(ae.a,{boxSize:"16px",src:t,alt:"Favicon",transition:"opacity 0.2s ease-in",opacity:Number(c)})})}function ue(e){var t,n=e.bookmark,r=e.onBookmarkUpdate,c=e.onBookmarkDelete,o=Object(U.a)(),i=o.isOpen,u=o.onOpen,l=o.onClose,b=(t=n.url,Object(s.useMemo)((function(){try{var e=new URL(t);return"".concat(e.origin,"/favicon.ico")}catch(n){return null}}),[t]));return Object(a.jsxs)(x.a,{border:"1px",borderColor:"gray.200",borderRadius:8,px:4,py:2,children:[Object(a.jsxs)(ce.a,{justify:"space-between",children:[Object(a.jsxs)(x.a,{children:[Object(a.jsx)(B.a,{isExternal:!0,href:n.url,children:Object(a.jsxs)(h.a,{as:"h3",size:"m",display:"flex",alignItems:"center",children:[b&&Object(a.jsx)(se,{url:b}),Object(a.jsx)(x.a,{ml:b?2:0,children:n.name})]})}),Object(a.jsx)(S.a,{mb:1,children:n.description}),Object(a.jsx)(oe.a,{spacing:2,children:n.tags.map((function(e){return Object(a.jsx)(oe.b,{children:Object(a.jsx)(ie.a,{size:"sm",children:e})},e)}))})]}),Object(a.jsxs)(v.b,{children:[Object(a.jsx)(ne,{bookmark:n,onBookmarkUpdate:r}),Object(a.jsx)(g.a,{"aria-label":"Delete bookmark",icon:Object(a.jsx)(re.a,{}),onClick:u})]})]}),Object(a.jsxs)(I.a,{onClose:l,isOpen:i,children:[Object(a.jsx)(I.g,{}),Object(a.jsxs)(I.d,{children:[Object(a.jsx)(I.f,{children:"Are you sure?"}),Object(a.jsxs)(I.b,{children:["Deleting bookmark: ",Object(a.jsx)("strong",{children:n.name})]}),Object(a.jsxs)(I.e,{children:[Object(a.jsx)(M.a,{onClick:l,mr:3,children:"Cancel"}),Object(a.jsx)(M.a,{colorScheme:"red",onClick:function(){c(n.id),l()},children:"Delete"})]})]})]})]})}var le=n(69);function be(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{version:e,bookmarks:[]}}var je={0:function(e){return e.bookmarks.forEach((function(e){var t=(new Date).toISOString();e.createdAt=e.updatedAt=t})),e.version=1,e}};function de(e){for(;1!==e.version;){var t,n=Number(null!==(t=e.version)&&void 0!==t?t:0);e=n in je?je[n](e):be(1)}return e}function pe(e){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(d.a)(j.a.mark((function e(t){var n,r,a,c,o=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"Untitled",r=o.length>2?o[2]:void 0,a=new Blob([JSON.stringify(t)],{type:"application/json"}),e.next=5,Object(le.b)(a,{fileName:n,description:"My bookmarks file",extensions:[".mbms"]},r);case 5:return c=e.sent,e.abrupt("return",{fileHandle:c});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(){return fe.apply(this,arguments)}function fe(){return(fe=Object(d.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(le.a)({description:"My bookmarks file",extensions:[".mbms"]});case 2:return t=e.sent,e.t0=de,e.t1=JSON,e.next=7,t.text();case 7:return e.t2=e.sent,e.t3=e.t1.parse.call(e.t1,e.t2),e.t4=(0,e.t0)(e.t3),e.t5=t.name,e.t6=t.handle,e.abrupt("return",{state:e.t4,name:e.t5,handle:e.t6});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(e,t){switch(t.type){case"NewBookmark":return Object(r.a)(Object(r.a)({},e),{},{bookmarks:e.bookmarks.concat(t.payload)});case"UpdateBookmark":var n=e.bookmarks.findIndex((function(e){return e.id===t.payload.id})),a=[].concat(Object(O.a)(e.bookmarks.slice(0,n)),[t.payload],Object(O.a)(e.bookmarks.slice(n+1)));return Object(r.a)(Object(r.a)({},e),{},{bookmarks:a});case"DeleteBookmark":return Object(r.a)(Object(r.a)({},e),{},{bookmarks:e.bookmarks.filter((function(e){return e.id!==t.payload}))});case"SetState":return t.payload}}var xe,he=function(e){var t=e.initialState,n=e.onStateChange,r=Object(s.useReducer)(ke,t),c=Object(p.a)(r,2),o=c[0],i=c[1],u=Object(s.useState)(""),l=Object(p.a)(u,2),b=l[0],O=l[1],D=Object(s.useState)(),N=Object(p.a)(D,2),I=N[0],F=N[1],M=Object(s.useState)(!1),U=Object(p.a)(M,2),T=U[0],L=U[1],J=Object(f.a)();Object(s.useEffect)((function(){var e=setTimeout((function(){n(o)}),100);return function(){return clearTimeout(e)}}),[n,o]),Object(s.useEffect)((function(){T&&pe(o,null===I||void 0===I?void 0:I.name,I).catch((function(e){e.code!==DOMException.ABORT_ERR&&J({title:"Error",description:e.message,status:"error",isClosable:!0})}))}),[T,I,o,J]);var q=o.bookmarks,z=Object(s.useMemo)((function(){return Object(R.a)(q.slice().sort((function(e,t){return e.updatedAt<t.updatedAt?-1:1})),b,{keys:["name","tags","description"]})}),[b,q]);function H(){return(H=Object(d.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,me();case 3:t=e.sent,F(t.handle),i({type:"SetState",payload:t.state}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),e.t0.code!==DOMException.ABORT_ERR&&J({title:"Error",description:e.t0.message,status:"error",isClosable:!0});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function V(){return(V=Object(d.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,pe(o,null===I||void 0===I?void 0:I.name,I);case 3:t=e.sent,F(t.fileHandle),J({title:"Saved",description:"Bookmarks saved to "+t.fileHandle.name,status:"success",duration:2e3,isClosable:!0}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),e.t0.code!==DOMException.ABORT_ERR&&J({title:"Error",description:e.t0.message,status:"error",isClosable:!0});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}return Object(a.jsxs)(k.a,{py:8,children:[Object(a.jsxs)(x.a,{as:"header",display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[Object(a.jsx)(h.a,{as:"h1",children:"My bookmarks."}),Object(a.jsxs)(v.a,{children:[Object(a.jsx)(g.a,{"aria-label":"Open file",title:"Open file",icon:Object(a.jsx)(m.a,{as:E.a}),onClick:function(){return H.apply(this,arguments)}}),Object(a.jsx)(g.a,{"aria-label":"Save to file",title:"Save to file",icon:Object(a.jsx)(m.a,{as:E.b}),onClick:function(){return V.apply(this,arguments)}}),Object(a.jsx)(te,{onBookmarkCreate:function(e){i({type:"NewBookmark",payload:e})}})]})]}),Object(a.jsx)(y.a,{in:Boolean(I),animateOpacity:!0,children:I&&Object(a.jsxs)(x.a,{display:"flex",justifyContent:"space-between",pb:2,children:[Object(a.jsx)(S.a,{children:I.name}),Object(a.jsx)(w.a,{checked:T,onChange:function(e){return L(e.target.checked)},children:"Autosave"})]})}),Object(a.jsx)(C.a,{placeholder:"Search",value:b,onChange:function(e){return O(e.target.value)},mb:8,mt:8}),0===z.length&&Object(a.jsx)(x.a,{textAlign:"center",color:"gray.500",children:"No bookmarks yet. Let's add the first bookmark!"}),Object(a.jsx)(v.b,{spacing:4,align:"stretch",children:z.map((function(e){return Object(a.jsx)(ue,{bookmark:e,onBookmarkUpdate:function(e){return i({type:"UpdateBookmark",payload:e})},onBookmarkDelete:function(e){return i({type:"DeleteBookmark",payload:e})}},e.id)}))}),Object(a.jsx)(x.a,{as:"footer",mt:10,display:"flex",justifyContent:"flex-end",children:Object(a.jsxs)(B.a,{href:"https://github.com/nanot1m/my-bookmarks-app",isExternal:!0,color:"gray.500",children:[Object(a.jsx)(m.a,{as:A.a})," nanot1m"]})})]})},ve=function(e){e&&e instanceof Function&&n.e(12).then(n.bind(null,165)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))},ge="MyBookmarksAppState",ye={getState:function(){return Object(d.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem(ge),e.abrupt("return",t?JSON.parse(t):be(1));case 2:case"end":return e.stop()}}),e)})))()},setState:function(e){localStorage.setItem(ge,JSON.stringify(e))}},Se=(xe=ye,{getState:function(){return Object(d.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,xe.getState();case 3:if(1===(t=e.sent).version){e.next=8;break}return n=de(t),xe.setState(n),e.abrupt("return",n);case 8:return e.abrupt("return",t);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",be(1));case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()},setState:function(e){xe.setState(e)}});Se.getState().then((function(e){var t=Object(c.a)({config:{useSystemColorMode:!0}});l.a.render(Object(a.jsxs)(s.StrictMode,{children:[Object(a.jsx)(o.a,{}),Object(a.jsx)(i.a,{theme:t,children:Object(a.jsx)(he,{initialState:e,onStateChange:Se.setState})})]}),document.getElementById("root"))})),window.setTestBookmarks=function(){var e=[P({name:"google",url:"https://www.google.com",description:"big search engine",tags:["google","search"]}),P({name:"instagram",url:"https://www.instagram.com/",description:"share photoes and videos",tags:["photo","video","image","social","media"]}),P({name:"youtube",url:"https://www.youtube.com",tags:["google","video"]})];ye.setState(Object(r.a)(Object(r.a)({},be(1)),{},{bookmarks:e})),window.location.reload()},ve()}},[[120,1,2]]]);
//# sourceMappingURL=main.5f6bcd3a.chunk.js.map