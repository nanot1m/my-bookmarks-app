(this["webpackJsonpmy-notes-app"]=this["webpackJsonpmy-notes-app"]||[]).push([[0],{171:function(e,t,n){"use strict";n.r(t);var a=n(9),r=n.n(a),c=n(5),o=n(15),i=n(18),s=n(225),l=n(213),u=n(219),b=n(1),d=n(43),j=n.n(d),p=n(11),O=n(138),f=n(217),m=n(212),k=n(205),x=n(208),h=n(226),v=n(231),g=n(209),y=n(218),w=n(227),S=n(207),C=n(127),B=n(92),R=n(133),N=n(203),E=n(204),A=n(215),D=n(222),F=n(136),I=n(199),M=n(137),H=n(44),T=r.a.mark(L),U=r.a.mark(_);function L(e){var t,n,a,c;return r.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t=new Set,n=Object(H.a)(e),r.prev=2,n.s();case 4:if((a=n.n()).done){r.next=13;break}if(c=a.value,!t.has(c)){r.next=8;break}return r.abrupt("continue",11);case 8:return r.next=10,c;case 10:t.add(c);case 11:r.next=4;break;case 13:r.next=18;break;case 15:r.prev=15,r.t0=r.catch(2),n.e(r.t0);case 18:return r.prev=18,n.f(),r.finish(18);case 21:case"end":return r.stop()}}),T,null,[[2,15,18,21]])}function _(e,t){var n,a,c;return r.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=Object(H.a)(t),r.prev=1,n.s();case 3:if((a=n.n()).done){r.next=9;break}return c=a.value,r.next=7,e(c);case 7:r.next=3;break;case 9:r.next=14;break;case 11:r.prev=11,r.t0=r.catch(1),n.e(r.t0);case 14:return r.prev=14,n.f(),r.finish(14);case 17:case"end":return r.stop()}}),U,null,[[1,11,14,17]])}function J(e){return 1===e.split("//").length?"https://".concat(e):e}function q(e){return t=L(_((function(e){return e.toLowerCase()}),e)),Array.from(t);var t}function z(e){var t=e.name,n=e.url,a=e.description,r=void 0===a?"":a,c=e.tags,o=void 0===c?[]:c,i=(new Date).toISOString();return{id:Object(M.a)(),url:J(n),name:t,description:r,tags:q(o),createdAt:i,updatedAt:i}}var P=n(52),V=n(198),G=n(229),K=n(106),Q=n(4);var W=n(216),X=n(200);function Y(e){return Object(Q.jsx)(W.a,{label:e.title,placement:"top",children:Object(Q.jsx)(X.a,{"aria-label":e["aria-label"],icon:e.icon,onClick:e.onClick})})}var Z={Form:function(e){return Object(Q.jsx)(K.b,{initialValues:e.initialValues,onSubmit:e.onSubmit,validate:e.validate,render:function(t){var n=t.handleSubmit;return Object(Q.jsx)("form",{onSubmit:n,children:e.children})}})},Field:function(e){return Object(Q.jsx)(K.a,{name:e.name,render:function(t){var n=t.input,a=t.meta;return Object(Q.jsxs)(P.a,{id:e.id,isRequired:e.isRequired,isInvalid:a.touched&&a.error,children:[Object(Q.jsx)(V.a,{children:e.label}),e.render(n),Object(Q.jsxs)(G.b,{children:[Object(Q.jsx)(G.a,{})," ",a.error]})]})}})}},$=Z.Form,ee=Z.Field;function te(e){var t,n,a={};return 0===((null===(t=e.name)||void 0===t?void 0:t.trim())||"").length&&(a.name="Name can not be empty"),0===((null===(n=e.url)||void 0===n?void 0:n.trim())||"").length&&(a.url="URL can not be empty"),a}function ne(e){var t,n,a,r,c=e.title,i=e.bookmark,s=e.isOpen,l=e.onClose,u=e.onSubmit,d=Object(b.useRef)(null);var j={description:null!==(t=null===i||void 0===i?void 0:i.description)&&void 0!==t?t:"",name:null!==(n=null===i||void 0===i?void 0:i.name)&&void 0!==n?n:"",tags:null!==(a=null===i||void 0===i?void 0:i.tags.join(", "))&&void 0!==a?a:"",url:null!==(r=null===i||void 0===i?void 0:i.url)&&void 0!==r?r:""};return Object(Q.jsxs)(A.a,{isOpen:s,onClose:l,children:[Object(Q.jsx)(A.g,{}),Object(Q.jsx)($,{onSubmit:function(e){var t={name:e.name,description:e.description,url:e.url,tags:e.tags.split(/[\s,]+/).filter(Boolean)};u(i?function(e,t){var n,a;return Object(o.a)(Object(o.a)(Object(o.a)({},e),t),{},{url:J(null!==(n=t.url)&&void 0!==n?n:e.url),tags:q(null!==(a=t.tags)&&void 0!==a?a:e.tags),updatedAt:(new Date).toISOString()})}(i,t):z(t)),l()},initialValues:j,validate:te,children:Object(Q.jsxs)(A.d,{children:[Object(Q.jsx)(A.f,{children:c}),Object(Q.jsx)(A.c,{}),Object(Q.jsx)(A.b,{children:Object(Q.jsxs)(h.b,{children:[Object(Q.jsx)(ee,{name:"name",label:"Name",id:"bookmark-name",isRequired:!0,render:function(e){return Object(Q.jsx)(w.a,Object(o.a)({ref:d},e))}}),Object(Q.jsx)(ee,{name:"url",label:"URL",id:"bookmark-url",isRequired:!0,render:function(e){return Object(Q.jsx)(w.a,Object(o.a)({},e))}}),Object(Q.jsx)(ee,{name:"description",label:"Description",id:"bookmark-description",render:function(e){return Object(Q.jsx)(D.a,Object(o.a)({},e))}}),Object(Q.jsx)(ee,{name:"tags",label:"Tags",id:"bookmark-tags",render:function(e){return Object(Q.jsx)(D.a,Object(o.a)({},e))}})]})}),Object(Q.jsxs)(A.e,{children:[Object(Q.jsx)(F.a,{mr:3,onClick:l,children:"Cancel"}),Object(Q.jsx)(F.a,{colorScheme:"blue",type:"submit",children:"Save"})]})]})})]})}function ae(e){var t=e.onBookmarkCreate,n=Object(I.a)(),a=n.onClose,r=n.onOpen,c=n.isOpen;return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(Y,{"aria-label":"Add bookmark",title:"Add bookmark",icon:Object(Q.jsx)(N.a,{}),onClick:r}),Object(Q.jsx)(ne,{title:"New bookmark",onClose:a,isOpen:c,onSubmit:t})]})}function re(e){var t=e.bookmark,n=e.onBookmarkUpdate,a=Object(I.a)(),r=a.onClose,c=a.onOpen,o=a.isOpen;return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(Y,{"aria-label":"New bookmakr",icon:Object(Q.jsx)(E.a,{}),onClick:c}),Object(Q.jsx)(ne,{title:"Edit bookmark",bookmark:t,onClose:r,isOpen:o,onSubmit:n})]})}var ce=n(211),oe=n(223),ie=n(206),se=n(210),le=n(224);function ue(e){var t=e.url,n=Object(b.useState)(!1),a=Object(c.a)(n,2),r=a[0],o=a[1],i=Object(b.useRef)(new Image);return Object(b.useEffect)((function(){var e=!1;return i.current.src=t,i.current.onload=function(){e||o(!0)},function(){o(!1),e=!0}}),[t]),Object(Q.jsx)(k.a,{background:"gray.50",width:"24px",height:"24px",rounded:"full",display:"flex",justifyContent:"center",alignItems:"center",children:Object(Q.jsx)(oe.a,{boxSize:"16px",src:t,alt:"Favicon",transition:"opacity 0.2s ease-in",opacity:Number(r)})})}function be(e){var t,n=e.bookmark,a=e.onBookmarkUpdate,r=e.onBookmarkDelete,c=Object(I.a)(),o=c.isOpen,i=c.onOpen,s=c.onClose,l=(t=n.url,Object(b.useMemo)((function(){try{var e=new URL(t);return"".concat(e.origin,"/favicon.ico")}catch(n){return null}}),[t]));return Object(Q.jsxs)(k.a,{border:"1px",borderColor:"gray.200",borderRadius:8,px:4,py:2,children:[Object(Q.jsxs)(ie.a,{justify:"space-between",children:[Object(Q.jsxs)(k.a,{children:[Object(Q.jsx)(S.a,{isExternal:!0,href:n.url,children:Object(Q.jsxs)(x.a,{as:"h3",size:"m",display:"flex",alignItems:"center",children:[l&&Object(Q.jsx)(ue,{url:l}),Object(Q.jsx)(k.a,{ml:l?2:0,children:n.name})]})}),Object(Q.jsx)(g.a,{mb:1,children:n.description}),Object(Q.jsx)(se.a,{spacing:2,children:n.tags.map((function(e){return Object(Q.jsx)(se.b,{children:Object(Q.jsx)(le.a,{size:"sm",children:e})},e)}))})]}),Object(Q.jsxs)(h.b,{children:[Object(Q.jsx)(re,{bookmark:n,onBookmarkUpdate:a}),Object(Q.jsx)(X.a,{"aria-label":"Delete bookmark",icon:Object(Q.jsx)(ce.a,{}),onClick:i})]})]}),Object(Q.jsxs)(A.a,{onClose:s,isOpen:o,children:[Object(Q.jsx)(A.g,{}),Object(Q.jsxs)(A.d,{children:[Object(Q.jsx)(A.f,{children:"Are you sure?"}),Object(Q.jsxs)(A.b,{children:["Deleting bookmark: ",Object(Q.jsx)("strong",{children:n.name})]}),Object(Q.jsxs)(A.e,{children:[Object(Q.jsx)(F.a,{onClick:s,mr:3,children:"Cancel"}),Object(Q.jsx)(F.a,{colorScheme:"red",onClick:function(){r(n.id),s()},children:"Delete"})]})]})]})]})}var de=n(105),je=n(104);function pe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{version:e,bookmarks:[]}}var Oe={0:function(e){return e.bookmarks.forEach((function(e){var t=(new Date).toISOString();e.createdAt=e.updatedAt=t})),e.version=1,e}};function fe(e){for(;1!==e.version;){var t,n=Number(null!==(t=e.version)&&void 0!==t?t:0);e=n in Oe?Oe[n](e):pe(1)}return e}var me="idb_file_handle_key";function ke(e){return xe.apply(this,arguments)}function xe(){return(xe=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(je.b)(me,t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(){return Object(je.a)(me)}function ve(e){return ge.apply(this,arguments)}function ge(){return(ge=Object(i.a)(r.a.mark((function e(t){var n,a,c,o,i=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"Untitled",a=i.length>2?i[2]:void 0,c=new Blob([JSON.stringify(t)],{type:"application/json"}),e.next=5,Object(de.b)(c,{fileName:n,description:"My bookmarks file",extensions:[".mbms"]},a);case 5:return o=e.sent,e.abrupt("return",{fileHandle:o});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ye(){return we.apply(this,arguments)}function we(){return(we=Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(de.a)({description:"My bookmarks file",extensions:[".mbms"]});case 2:return t=e.sent,e.t0=fe,e.t1=JSON,e.next=7,t.text();case 7:return e.t2=e.sent,e.t3=e.t1.parse.call(e.t1,e.t2),e.t4=(0,e.t0)(e.t3),e.t5=t.name,e.t6=t.handle,e.abrupt("return",{state:e.t4,name:e.t5,handle:e.t6});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Se(e,t){switch(t.type){case"NewBookmark":return Object(o.a)(Object(o.a)({},e),{},{bookmarks:e.bookmarks.concat(t.payload)});case"UpdateBookmark":var n=e.bookmarks.findIndex((function(e){return e.id===t.payload.id})),a=[].concat(Object(p.a)(e.bookmarks.slice(0,n)),[t.payload],Object(p.a)(e.bookmarks.slice(n+1)));return Object(o.a)(Object(o.a)({},e),{},{bookmarks:a});case"DeleteBookmark":return Object(o.a)(Object(o.a)({},e),{},{bookmarks:e.bookmarks.filter((function(e){return e.id!==t.payload}))});case"SetState":return t.payload;case"CreateNewFile":return Object(o.a)(Object(o.a)({},e),{},{bookmarks:[]})}}var Ce,Be=function(e){var t=e.initialState,n=e.initialFileHandle,a=e.onStateChange,s=Object(b.useReducer)(Se,t),l=Object(c.a)(s,2),u=l[0],d=l[1],j=Object(b.useState)(""),p=Object(c.a)(j,2),N=p[0],E=p[1],A=Object(b.useState)(n),D=Object(c.a)(A,2),F=D[0],I=D[1],M=Object(b.useState)(!1),H=Object(c.a)(M,2),T=H[0],U=H[1],L=Object(f.a)();Object(b.useEffect)((function(){var e=setTimeout((function(){a(u)}),100);return function(){return clearTimeout(e)}}),[a,u]),Object(b.useEffect)((function(){T&&ve(u,null===F||void 0===F?void 0:F.name,F).catch((function(e){e.code!==DOMException.ABORT_ERR&&L({title:"Error",description:e.message,status:"error",isClosable:!0})}))}),[T,F,u,L]);var _=u.bookmarks,J=Object(b.useMemo)((function(){return Object(C.a)(_.slice().sort((function(e,t){return e.updatedAt<t.updatedAt?-1:1})),N,{keys:["name","tags","description"]})}),[N,_]);function q(){return(q=Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ye();case 3:t=e.sent,I(t.handle),t.handle&&ke(t.handle),d({type:"SetState",payload:t.state}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),e.t0.code!==DOMException.ABORT_ERR&&L({title:"Error",description:e.t0.message,status:"error",isClosable:!0});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function z(){return(z=Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ve(u,null===F||void 0===F?void 0:F.name,F);case 3:t=e.sent,I(t.fileHandle),L({title:"Saved",description:"Bookmarks saved to "+t.fileHandle.name,status:"success",duration:2e3,isClosable:!0}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),e.t0.code!==DOMException.ABORT_ERR&&L({title:"Error",description:e.t0.message,status:"error",isClosable:!0});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function P(){return(P=Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ve(Object(o.a)(Object(o.a)({},u),{},{bookmarks:[]}));case 3:t=e.sent,d({type:"CreateNewFile"}),I(t.fileHandle),ke(t.fileHandle),U(!1),L({title:"New file created",description:'New file "'.concat(t.fileHandle.name,'" created'),status:"success",duration:2e3,isClosable:!0}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),e.t0.code!==DOMException.ABORT_ERR&&L({title:"Failed to create a new file",description:e.t0.message,status:"error",isClosable:!0});case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}return Object(Q.jsxs)(m.a,{py:8,children:[Object(Q.jsxs)(k.a,{as:"header",display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[Object(Q.jsx)(x.a,{as:"h1",children:"My bookmarks."}),Object(Q.jsxs)(h.a,{children:[Object(Q.jsx)(Y,{"aria-label":"New file",title:"New file",icon:Object(Q.jsx)(O.a,{as:B.a}),onClick:function(){return P.apply(this,arguments)}}),Object(Q.jsx)(Y,{"aria-label":"Open file",title:"Open file",icon:Object(Q.jsx)(O.a,{as:B.b}),onClick:function(){return q.apply(this,arguments)}}),Object(Q.jsx)(Y,{"aria-label":"Save to file",title:"Save to file",icon:Object(Q.jsx)(O.a,{as:B.c}),onClick:function(){return z.apply(this,arguments)}})]})]}),Object(Q.jsx)(v.a,{in:Boolean(F),animateOpacity:!0,children:F&&Object(Q.jsxs)(k.a,{display:"flex",justifyContent:"space-between",pb:2,children:[Object(Q.jsx)(g.a,{children:F.name}),Object(Q.jsx)(y.a,{checked:T,onChange:function(e){return U(e.target.checked)},children:"Autosave"})]})}),Object(Q.jsxs)(h.a,{children:[Object(Q.jsx)(w.a,{placeholder:"Search",value:N,onChange:function(e){return E(e.target.value)},mb:8,mt:8}),Object(Q.jsx)(ae,{onBookmarkCreate:function(e){d({type:"NewBookmark",payload:e})}})]}),0===J.length&&Object(Q.jsx)(k.a,{textAlign:"center",color:"gray.500",children:"No bookmarks yet. Let's add the first bookmark!"}),Object(Q.jsx)(h.b,{spacing:4,align:"stretch",children:J.map((function(e){return Object(Q.jsx)(be,{bookmark:e,onBookmarkUpdate:function(e){return d({type:"UpdateBookmark",payload:e})},onBookmarkDelete:function(e){return d({type:"DeleteBookmark",payload:e})}},e.id)}))}),Object(Q.jsx)(k.a,{as:"footer",mt:10,display:"flex",justifyContent:"flex-end",children:Object(Q.jsxs)(S.a,{href:"https://github.com/nanot1m/my-bookmarks-app",isExternal:!0,color:"gray.500",children:[Object(Q.jsx)(O.a,{as:R.a})," nanot1m"]})})]})},Re=function(e){e&&e instanceof Function&&n.e(12).then(n.bind(null,242)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),c(e),o(e)}))},Ne="MyBookmarksAppState",Ee={getState:function(){return Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem(Ne),e.abrupt("return",t?JSON.parse(t):pe(1));case 2:case"end":return e.stop()}}),e)})))()},setState:function(e){localStorage.setItem(Ne,JSON.stringify(e))}},Ae=(Ce=Ee,{getState:function(){return Object(i.a)(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ce.getState();case 3:if(1===(t=e.sent).version){e.next=8;break}return n=fe(t),Ce.setState(n),e.abrupt("return",n);case 8:return e.abrupt("return",t);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",pe(1));case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()},setState:function(e){Ce.setState(e)}});function De(){return(De=Object(i.a)(r.a.mark((function e(){var t,n,a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([he(),Ae.getState()]);case 2:return t=e.sent,n=Object(c.a)(t,2),a=n[0],o=n[1],e.abrupt("return",{state:o,fileHandle:a});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return De.apply(this,arguments)})().then((function(e){var t=e.state,n=e.fileHandle,a=Object(s.a)({config:{useSystemColorMode:!0}});j.a.render(Object(Q.jsxs)(b.StrictMode,{children:[Object(Q.jsx)(l.a,{}),Object(Q.jsx)(u.a,{theme:a,children:Object(Q.jsx)(Be,{initialState:t,initialFileHandle:n,onStateChange:Ae.setState})})]}),document.getElementById("root"))})),window.setTestBookmarks=function(){var e=[z({name:"google",url:"https://www.google.com",description:"big search engine",tags:["google","search"]}),z({name:"instagram",url:"https://www.instagram.com/",description:"share photoes and videos",tags:["photo","video","image","social","media"]}),z({name:"youtube",url:"https://www.youtube.com",tags:["google","video"]})];Ee.setState(Object(o.a)(Object(o.a)({},pe(1)),{},{bookmarks:e})),window.location.reload()},Re()}},[[171,1,2]]]);
//# sourceMappingURL=main.4a4af593.chunk.js.map